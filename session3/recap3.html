<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>

<body>
    <h2>Hola</h2>


    <div id="users-here">

    </div>

    <hr>

    <div id="todos-here">

    </div>



    <button id="afiseaza-date">Click for date</button>

    <script>

        var users_ = [];
        var todos_ = [];

        console.log('---step 1-----')
        $.ajax({
            url: 'https://jsonplaceholder.typicode.com/users',
            success: function (userii) {
                console.log('am luat datele: ', userii);
                users_ = userii;
                // displayTheInformation();
                usersToHtml();

                // in punctul acesta, user-ii deja au fost incarcati
                // 
                $.ajax({
                    url: 'https://jsonplaceholder.typicode.com/todos',
                    success: function (todos) {
                        for (var td of todos) {

                            // td.userId <--- 1,2,3...10
                            for(var user of users_){
                                if(user.id == td.userId){
                                    td.associatedDude = user;
                                }
                            }
                            
                        }
                        console.log('am luat todo-urile: ', todos);
                        todos_ = todos;
                        todosToHtml();
                    }
                });

            }
        });

        console.log('---step 2-----')



        console.log('---step 3-----')

        function displayTheInformation() {
            console.log('-------------displaying-data-start---------');
            console.log('USERS: ', users_);
            console.log('TODOS: ', todos_);
            console.log('-------------displaying-data-end---------');
        }

        function todosToHtml() {
            $('#todos-here').append('<ul>');
            for (var todo of todos_) {
                $('#todos-here').append(`<li>${todo.id} - ${todo.title} <span style="color: red;">belongs to: ${todo.userId} his name is: ${todo.associatedDude.username}</span></li>`);
            }
            $('#todos-here').append('</ul>');
        }

        function usersToHtml() {
            $('#users-here').append('<ul>');
            for (var user of users_) {
                $('#users-here').append(`<li>${user.id} - ${user.name} - ${user.username}</li>`);
            }
            $('#users-here').append('</ul>');
        }




        // displayTheInformation();

        // $('#afiseaza-date').click(function () {
        //     console.log('-------------displaying-data-start---------');
        //     console.log('USERS: ', users_);
        //     console.log('TODOS: ', todos_);
        //     console.log('-------------displaying-data-end---------');
        // });
    </script>
</body>

</html>